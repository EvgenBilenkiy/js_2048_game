{"version":3,"sources":["scripts/main.js"],"names":["score","rows","columns","gameField","table","document","querySelector","button","startMessage","loseMessage","winMessage","gameScore","hasFieldChanged","currentField","fieldCopy","r","c","hasSpace","includes","addRandomValue","value","Math","floor","random","updateCells","start","classList","add","replace","innerText","isLost","isWin","some","row","cell","remove","updateScore","innerHTML","cells","move","rowWithoutZeros","filter","el","i","isFinite","length","push","moveUp","moveDown","reverse","moveRight","moveLeft","addEventListener","e","map","arr","slice","preventDefault","code"],"mappings":"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","file":"main.43abd12d.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\n\n\nlet score = 0;\nconst rows = 4;\nconst columns = 4;\nlet gameField = [\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n];\n\nconst table = document.querySelector('.game-field');\nconst button = document.querySelector('.button');\nconst startMessage = document.querySelector('.message-start');\nconst loseMessage = document.querySelector('.message-lose');\nconst winMessage = document.querySelector('.message-win');\nconst gameScore = document.querySelector('.game-score');\n\nbutton.addEventListener('click', start);\n\nfunction hasFieldChanged(currentField, fieldCopy) {\n  for (let r = 0; r < rows; r++) {\n    for (let c = 0; c < columns; c++) {\n      if (currentField[r][c] !== fieldCopy[r][c]) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction hasSpace() {\n  for (let r = 0; r < rows; r++) {\n    if (gameField[r].includes(0)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction addRandomValue() {\n  const value = Math.floor(Math.random()) < 0.9 ? 2 : 4;\n\n  while (hasSpace()) {\n    const r = Math.floor(Math.random() * rows);\n    const c = Math.floor(Math.random() * columns);\n\n    if (gameField[r][c] === 0) {\n      gameField[r][c] = value;\n      break;\n    }\n  }\n\n  updateCells();\n}\n\nfunction start() {\n  score = 0;\n\n  gameField = [\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n  ];\n\n  winMessage.classList.add('hidden');\n  startMessage.classList.add('hidden');\n  loseMessage.classList.add('hidden');\n  button.classList.replace('start', 'restart');\n  button.innerText = 'Restart';\n\n  addRandomValue();\n  addRandomValue();\n}\n\nfunction isLost() {\n  if (hasSpace()) {\n    return false;\n  }\n\n  for (let r = 0; r < rows; r++) {\n    for (let c = 0; c < columns - 1; c++) {\n      if (gameField[r][c] === gameField[r][c + 1]) {\n        return false;\n      }\n    }\n  }\n\n  for (let r = 0; r < rows - 1; r++) {\n    for (let c = 0; c < columns; c++) {\n      if (gameField[r][c] === gameField[r + 1][c]) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction isWin() {\n  if (gameField.some(row => row.some(cell => cell === 2048))) {\n    winMessage.classList.remove('hidden');\n  }\n}\n\nfunction updateScore() {\n  gameScore.innerHTML = score;\n}\n\nfunction updateCells() {\n  for (let r = 0; r < rows; r++) {\n    for (let c = 0; c < columns; c++) {\n      const cell = table.rows[r].cells[c];\n      const value = gameField[r][c];\n\n      cell.innerText = '';\n      cell.classList.value = '';\n      cell.classList.add('field-cell');\n\n      if (value > 0) {\n        cell.innerText = value;\n        cell.classList.add(`field-cell--${value}`);\n      }\n    }\n  }\n\n  isWin();\n\n  updateScore();\n\n  if (isLost()) {\n    loseMessage.classList.remove('hidden');\n  }\n}\n\nfunction move(row) {\n  let rowWithoutZeros = row.filter(el => el !== 0);\n\n  for (let i = 0; i < rows - 1; i++) {\n    if (rowWithoutZeros[i] === rowWithoutZeros[i + 1]\n        && isFinite(rowWithoutZeros[i])) {\n      rowWithoutZeros[i] *= 2;\n      rowWithoutZeros[i + 1] = 0;\n      score += rowWithoutZeros[i];\n    }\n  }\n\n  rowWithoutZeros = rowWithoutZeros.filter(el => el !== 0);\n\n  while (rowWithoutZeros.length < rows) {\n    rowWithoutZeros.push(0);\n  }\n\n  return rowWithoutZeros;\n}\n\nfunction moveUp() {\n  for (let c = 0; c < columns; c++) {\n    let row = [gameField[0][c], gameField[1][c],\n      gameField[2][c], gameField[3][c]];\n\n    row = move(row);\n\n    for (let r = 0; r < rows; r++) {\n      gameField[r][c] = row[r];\n    }\n  }\n}\n\nfunction moveDown() {\n  for (let c = 0; c < columns; c++) {\n    let row = [gameField[0][c], gameField[1][c],\n      gameField[2][c], gameField[3][c]];\n\n    row.reverse();\n    row = move(row);\n    row.reverse();\n\n    for (let r = 0; r < rows; r++) {\n      gameField[r][c] = row[r];\n    }\n  }\n}\n\nfunction moveRight() {\n  for (let r = 0; r < rows; r++) {\n    let row = gameField[r];\n\n    row.reverse();\n    row = move(row);\n    row.reverse();\n    gameField[r] = row;\n  }\n}\n\nfunction moveLeft() {\n  for (let r = 0; r < rows; r++) {\n    let row = gameField[r];\n\n    row = move(row);\n    gameField[r] = row;\n  }\n}\n\ndocument.addEventListener('keyup', e => {\n  const fieldCopy = gameField.map(arr => arr.slice());\n\n  e.preventDefault();\n\n  switch (e.code) {\n    case 'ArrowLeft':\n      moveLeft();\n      break;\n\n    case 'ArrowRight':\n      moveRight();\n      break;\n\n    case 'ArrowUp':\n      moveUp();\n      break;\n\n    case 'ArrowDown':\n      moveDown();\n      break;\n  }\n\n  if (hasFieldChanged(gameField, fieldCopy)) {\n    addRandomValue();\n  }\n\n  updateCells();\n});\n"]}